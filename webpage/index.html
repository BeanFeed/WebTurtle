<!DOCTYPE html>
<html lang="en">
    <head>
        <script type="text/javascript">
                window.onload = function() {
                    const Forward = document.getElementById("f");
                    const Back = document.getElementById("b");
                    const Left = document.getElementById("l");
                    const Right = document.getElementById("r");
                    const urll = document.getElementById("url");
                    const con = document.getElementById("con");
                    const dis = document.getElementById("dis");
                    const turtid = document.getElementById("turtid");
                    const turtpass = document.getElementById("turtpass");
                    const constat = document.getElementById("constat");
                    const Up = document.getElementById("u");
                    const Down = document.getElementById("d");
                    const Place = document.getElementById("place");
                    const Break = document.getElementById("break");
                    const Attack = document.getElementById("attack");

                    con.onclick = function(){
                        let conurl = urll.value;
                        if (conurl == null) return
                        let socket = new WebSocket(conurl);
                        socket.onopen = function (conurl) {
                            console.log("Connected To " + urll.value);
                            constat.innerHTML = "Connected";
                        }
                        
                        let msg = {
                            cmd: null,
                            id: null,
                            pass: null,
                            extra: null

                        };
                        msg.id = turtid.value;
                        msg.pass = turtpass.value;

                        Forward.onclick = function(){
                            msg.cmd = "turtle.forward()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));
                        }
                        Back.onclick = function () {
                            msg.cmd = "turtle.back()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));
                        }
                        
                        Left.onclick = function () {
                            msg.cmd = "turtle.turnLeft()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));   
                        }
                        
                        Right.onclick = function () {
                            msg.cmd = "turtle.turnRight()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));  
                        }
                        
                        Down.onclick = function () {
                            msg.cmd = "turtle.down()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));
                        }

                        Up.onclick = function () {
                            msg.cmd = "turtle.up()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));
                        }

                        Place.onclick = function () {
                            msg.cmd = "turtle.placeDown()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));
                        }

                        Break.onclick = function () {
                            msg.cmd = "turtle.digDown()"
                            socket.send(JSON.stringify(msg));

                            console.log(JSON.stringify(msg));
                        }

                        Attack.onclick = function () {
                            msg.cmd = "turtle.attackDown()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));
                        }

                        dis.onclick = function () {
                            socket.close(); 
                            constat.innerHTML = "Disconnected";  
                        }
                    }  
                }


        </script>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <div id="center">
        <h1>Turtle Control Page</h1>
        <button id = "place">Place</button>
        <button id = "break">Break</button>
        <button id= "attack">Attack</button>
        <br>
        <button id="u">Up</button>
        <button id="f">Forward</button>
        <button id="d">Down</button>
        <br>
        <button id="l">Left</button>
        <button id="b">Back</button>
        <button id="r">Right</button>
        <br>

        
        Turtle Id:
        <input type="number" id="turtid">
        <br>
        Turtle password: <input type = "text" id = "turtpass">
        <br>
        Url: <input type="text" id="url">
        <button id="con">Connect</button>
        <button id="dis">Disconnect</button>
        <br>
        Connection Status:
        <p id = "constat">Disconnected</p>
        </div>

    </body>
</html>
