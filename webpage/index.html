<!DOCTYPE html>
<html lang="en">
    <head>
        <script type="text/javascript">
                window.onload = function() {
                    const Forward = document.getElementById("f");
                    const Back = document.getElementById("b");
                    const Left = document.getElementById("l");
                    const Right = document.getElementById("r");
                    const urll = document.getElementById("url");
                    const con = document.getElementById("con");
                    const dis = document.getElementById("dis");
                    const turtid = document.getElementById("turtid");
                    const turtpass = document.getElementById("turtpass");
                    const constat = document.getElementById("constat");
                    const Up = document.getElementById("u");
                    const Down = document.getElementById("d");
                    const Place = document.getElementById("place");
                    const Break = document.getElementById("break");
                    const Attack = document.getElementById("attack");
                    var recMessage;

                    //Item Slot Variables
                    const slot1 = document.getElementById("slot1");
                    const slot2 = document.getElementById("slot2");
                    const slot3 = document.getElementById("slot3");
                    const slot4 = document.getElementById("slot4");
                    const slot5 = document.getElementById("slot5");
                    const slot6 = document.getElementById("slot6");
                    const slot7 = document.getElementById("slot7");
                    const slot8 = document.getElementById("slot8");
                    const slot9 = document.getElementById("slot9");
                    const slot10 = document.getElementById("slot10");
                    const slot11 = document.getElementById("slot11");
                    const slot12 = document.getElementById("slot12");
                    const slot13 = document.getElementById("slot13");
                    const slot14 = document.getElementById("slot14");
                    const slot15 = document.getElementById("slot15");
                    const slot16 = document.getElementById("slot16");
                    
                    function UpdateInv() {
                        Inv = recMessage.Inventory;
                        slot1.src = "resources/textures/" + Inv.slot1.name.replace('minecraft:','') + ".png"
                        slot2.src = "resources/textures/" + Inv.slot2.name.replace('minecraft:','') + ".png"
                        slot3.src = "resources/textures/" + Inv.slot3.name.replace('minecraft:','') + ".png"
                        slot4.src = "resources/textures/" + Inv.slot4.name.replace('minecraft:','') + ".png"
                        slot5.src = "resources/textures/" + Inv.slot5.name.replace('minecraft:','') + ".png"
                        slot6.src = "resources/textures/" + Inv.slot6.name.replace('minecraft:','') + ".png"
                        slot7.src = "resources/textures/" + Inv.slot7.name.replace('minecraft:','') + ".png"
                        slot8.src = "resources/textures/" + Inv.slot8.name.replace('minecraft:','') + ".png"
                        slot9.src = "resources/textures/" + Inv.slot9.name.replace('minecraft:','') + ".png"
                        slot10.src = "resources/textures/" + Inv.slot10.name.replace('minecraft:','') + ".png"
                        slot11.src = "resources/textures/" + Inv.slot11.name.replace('minecraft:','') + ".png"
                        slot12.src = "resources/textures/" + Inv.slot12.name.replace('minecraft:','') + ".png"
                        slot13.src = "resources/textures/" + Inv.slot13.name.replace('minecraft:','') + ".png"
                        slot14.src = "resources/textures/" + Inv.slot14.name.replace('minecraft:','') + ".png"
                        slot15.src = "resources/textures/" + Inv.slot15.name.replace('minecraft:','') + ".png"
                        slot16.src = "resources/textures/" + Inv.slot16.name.replace('minecraft:','') + ".png"
                        
                    }
                    var message;
                    con.onclick = function(){
                        let conurl = urll.value;
                        if (conurl == null) return
                        let socket = new WebSocket(conurl);
                        socket.onopen = function (conurl) {
                            console.log("Connected To " + urll.value);
                            constat.innerHTML = "Connected";
                        }
                        
                        let msg = {
                            cmd: null,
                            id: null,
                            pass: null,
                            extra: null,
                            fromWss: false,
                            log: true

                        };
                        msg.id = turtid.value;
                        msg.pass = turtpass.value;

                        socket.addEventListener("message", msg => {
                            recMessage = JSON.parse(msg.data);
                            UpdateInv();
                        });

                        Forward.onclick = function(){
                            msg.cmd = "turtle.forward()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));
                        }
                        Back.onclick = function () {
                            msg.cmd = "turtle.back()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));
                        }
                        
                        Left.onclick = function () {
                            msg.cmd = "turtle.turnLeft()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));   
                        }
                        
                        Right.onclick = function () {
                            msg.cmd = "turtle.turnRight()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));  
                        }
                        
                        Down.onclick = function () {
                            msg.cmd = "turtle.down()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));
                        }

                        Up.onclick = function () {
                            msg.cmd = "turtle.up()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));
                        }

                        Place.onclick = function () {
                            msg.cmd = "turtle.placeDown()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));
                        }

                        Break.onclick = function () {
                            msg.cmd = "turtle.digDown()"
                            socket.send(JSON.stringify(msg));

                            console.log(JSON.stringify(msg));
                        }

                        Attack.onclick = function () {
                            msg.cmd = "turtle.attackDown()"
                            socket.send(JSON.stringify(msg));
                            console.log(JSON.stringify(msg));
                        }

                        dis.onclick = function () {
                            socket.close(); 
                            constat.innerHTML = "Disconnected";
                        }
                    }  
                }


        </script>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <div id="center">
        <h1>Turtle Control Page</h1>
        <button id = "place">Place</button>
        <button id = "break">Break</button>
        <button id= "attack">Attack</button>
        <br>
        <button id="u">Up</button>
        <button id="f">Forward</button>
        <button id="d">Down</button>
        <br>
        <button id="l">Left</button>
        <button id="b">Back</button>
        <button id="r">Right</button>
        <br>

        
        Turtle Id:
        <input type="number" id="turtid">
        <br>
        Turtle password: <input type = "text" id = "turtpass">
        <br>
        Url: <input type="text" id="url">
        <button id="con">Connect</button>
        <button id="dis">Disconnect</button>
        <br>
        Connection Status:
        <p id = "constat">Disconnected</p>
        </div>


        <div>
            <h1>Inventory</h1>
            <table style="border-collapse: collapse;" background="resources/Inventory.png" class="inv">
                <tr class = "one">
                    <td style = "padding-left: 4.4px; padding-right: 0px;" class = "r1"><img class = "slot" id = "slot1" src="resources/Blank.png"></td>
                    <td class = "r1"><img class = "slot" id = "slot2" src="resources/Blank.png"></td>
                    <td class = "r1"><img class = "slot" id = "slot3" src="resources/Blank.png"></td>
                    <td class = "r1"><img class = "slot" id = "slot4" src="resources/Blank.png"></td>
                </tr>

                <tr>
                    <td style = "padding-left: 4.4px; padding-right: 0px;" class = "r2"><img class = "slot" id = "slot5" src="resources/Blank.png"></td>
                    <td class = "r2"><img class = "slot" id = "slot6" src="resources/Blank.png"></td>
                    <td class = "r2"><img class = "slot" id = "slot7" src="resources/Blank.png"></td>
                    <td class = "r2"><img class = "slot" id = "slot8" src="resources/Blank.png"></td>
                </tr>

                <tr>
                    <td style = "padding-left: 4.4px; padding-right: 0px;" class = "r3"><img class = "slot" id = "slot9" src="resources/Blank.png"></td>
                    <td class = "r3"><img class = "slot" id = "slot10" src="resources/Blank.png"></td>
                    <td class = "r3"><img class = "slot" id = "slot11" src="resources/Blank.png"></td>
                    <td class = "r3"><img class = "slot" id = "slot12" src="resources/Blank.png"></td>
                </tr>

                <tr>
                    <td style = "padding-left: 4.4px; padding-right: 0px;" class = "r4"><img class = "slot" id = "slot13" src="resources/Blank.png"></td>
                    <td class = "r4"><img class = "slot" id = "slot14" src="resources/Blank.png"></td>
                    <td class = "r4"><img class = "slot" id = "slot15" src="resources/Blank.png"></td>
                    <td class = "r4"><img class = "slot" id = "slot16" src="resources/Blank.png"></td>
                </tr>

            </table>

        </div>
    </body>
</html>
